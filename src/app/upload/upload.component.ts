import { Component, OnInit } from '@angular/core';
import { DomSanitizer } from '@angular/platform-browser';
import { SharedService } from '../services/shared.service';
import { Router } from '@angular/router';

declare const Camera;

@Component({
  selector: 'app-upload',
  templateUrl: './upload.component.html',
  styleUrls: ['./upload.component.scss'],
})
export class UploadComponent implements OnInit {
  public showLinkModal: boolean;
  public photoLink: string;

  constructor(
    private sanitizer: DomSanitizer,
    public shared: SharedService,
    public router: Router
  ) {
    shared.appBarLabel = 'Tori';
  }

  ngOnInit(): void {}

  public triggerCamera(): void {
    const self = this;
    (<any>navigator).camera.getPicture(onSuccess, onFail, {
      destinationType: Camera.DestinationType.DATA_URL,
    });
    function onSuccess(uri): void {
      new Promise(() => {
        self.shared.uploadedImage = `data:image/jpeg;base64,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`;
      }).then(() => self.router.navigateByUrl('/confirmacao'));
    }
    function onFail(err): void {
      console.log(err);
    }
  }

  public uploadOpen(): void {
    const input: any = document.querySelector('input#img');
    input.click();
  }

  public setUploadedImage(input): void {
    this.shared.uploadedImage = this.sanitizer.bypassSecurityTrustUrl(
      URL.createObjectURL(input.files[0])
    );
    this.router.navigateByUrl('/confirmacao');
  }

  public setUploadedUrl(url): void {
    this.shared.uploadedImage = url;
    this.router.navigateByUrl('/confirmacao');
  }
}
